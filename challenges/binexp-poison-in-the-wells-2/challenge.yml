name: '# poison-in-the-wells-2'
author: CSSA
category: Binary Exploitation
description: 'That witness testimony about the truck was a good find! Well, maybe. More like it''s the only thing resembling a lead that we have, so might as well follow it.


  There''s only one Tesla dealership in town, so we asked to take a look at their transaction database. They agreed to let us see a list of purchases, but it just has dates and subtotals. They won''t let us see any of the transaction details without a warrant.


  Well, getting a warrant is far too much paperwork for my old age. Maybe you can find a hole in the system to get us the full transaction details?


  Connect with SSH:

  - Enter this command in your terminal: `ssh guest@poison-in-the-wells-2.ctf.umanitobacssa.ca -p 30202`

  - Enter this password when prompted: `ctf2025!`


  *A copy of the server software and source code is provided for your reference. The binary is identical to the hosted version, however the flag can only be found in the hosted version of the program.*


  Hints:

  1. The authorization level gets checked in the process_input function after typing the details command. Is there some other way to call the details function?

  2. The process_input function returns back to the main function after each command before getting called again. Is there something we can do to "return" somewhere else?

  3. The process_input function remembers where to return by storing a memory address on the stack. Do we have some way to control data on the stack?

  4. This might be a helpful resource: <https://ctf101.org/binary-exploitation/buffer-overflow/>'
value: 300
type: standard
state: visible
flags:
- flag: cssactf{r3TurN-t0-Cu5t0m3R-5ed363eb}
  type: static
tags:
- Medium
files: []
